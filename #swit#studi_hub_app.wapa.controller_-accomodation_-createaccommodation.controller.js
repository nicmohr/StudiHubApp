sap.ui.define(["Mosbach/StudiHub/controller/base.controller","sap/m/UploadCollectionParameter","sap/m/MessageToast"],function(e,t,a){"use strict";return e.extend("Mosbach.StudiHub.controller.Accomodation.CreateAccommodation",{extendInit:function(){this.o+
nLiveChange();this.oRouter.getRoute("RouteCreateAccommodation").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(){this.byId("panelData").bindElement("/UserSet('"+this.oSession.getData().myUserId+"')");this.byId("inputHeader").+
setValue("");this.byId("textArea").setValue("");this.byId("inputRooms").setValue("1");this.byId("inputNumber").setValue();this.byId("inputPrice").setValue();this.byId("dateRange").setDateValue();this.byId("dateRange").setSecondDateValue();this.byId("Uplo+
adCollection").removeAllItems();this.xBinary=""},onLiveChange:function(e){var t=this.byId("inputHeader").getValue();var a=this.byId("inputStreet").getValue();var i=this.byId("inputRooms").getValue()+" Zimmer "+this.byId("inputNumber").getValue()+"qm";var+
 s=this.byId("inputPrice").getValue();if(this.byId("dateRange").getSecondDateValue()){var n="Bis: "+this.dateFormatter(this.byId("dateRange").getSecondDateValue())}this.generateAccommodationTile(t,a,i,s,n)},generateAccommodationTile:function(e,t,a,i,s){v+
ar n=new sap.m.GenericTile;var o=new sap.m.TileContent;var r=new sap.m.FeedContent;n.addStyleClass("sapUiTinyMarginBegin");n.addStyleClass("sapUiTinyMarginTop");n.setFrameType("TwoByOne");n.setHeader(e);o.setFooter(s);r.setValue(i);r.setSubheader(a);r.se+
tContentText(t);o.setContent(r);n.addTileContent(o);this.byId("flexBoxPreview").destroyItems();this.byId("flexBoxPreview").addItem(n)},getAccom:function(){return{Postid:"0",Userid:this.oSession.getData().myUserId,Begda:this.removeTimeZoneOffset(this.byId+
("dateRange").getDateValue()),Endda:this.removeTimeZoneOffset(this.byId("dateRange").getSecondDateValue()),Title:this.byId("inputHeader").getValue(),Cost:this.byId("inputPrice").getValue(),Rooms:this.byId("inputRooms").getValue()+"",Area:this.byId("input+
Number").getValue(),Street:this.byId("inputStreet").getValue(),City:this.byId("inputCity").getValue(),Postcode:this.byId("inputPostcode").getValue(),Descr:this.byId("textArea").getValue(),Weblink:this.byId("inputWebsite").getValue(),Pdfbinary:this.xBinar+
y,Pdfsource:"",Uname:""}},onSavePress:function(){var e=this.getAccom();if(this.fieldsValid(e)){this.saveAccom(e)}},fieldsValid:function(e){var t=false;if(!e.Title){this.byId("inputHeader").setValueState("Error");t=true}else{this.byId("inputHeader").setVa+
lueState("None")}if(!e.Street){this.byId("inputStreet").setValueState("Error");t=true}else{this.byId("inputStreet").setValueState("None")}if(!e.Postcode){this.byId("inputPostcode").setValueState("Error");t=true}else{this.byId("inputPostcode").setValueSta+
te("None")}if(!e.City){this.byId("inputCity").setValueState("Error");t=true}else{this.byId("inputCity").setValueState("None")}if(!e.Rooms){this.byId("inputRooms").setValueState("Error");t=true}else{this.byId("inputRooms").setValueState("None")}if(!e.Cost+
){this.byId("inputPrice").setValueState("Error");t=true}else{this.byId("inputPrice").setValueState("None")}if(!e.Area){this.byId("inputNumber").setValueState("Error");t=true}else{this.byId("inputNumber").setValueState("None")}if(!e.Begda||!e.Endda){this.+
byId("dateRange").setValueState("Error");t=true}else{this.byId("dateRange").setValueState("None")}if(!e.Descr){this.byId("textArea").setValueState("Error");t=true}else{this.byId("textArea").setValueState("None")}if(t){a.show("Bitte f√ºlle alle Pflichtfeld+
er aus!")}return!t},saveAccom:function(e){var t=this;var i;this.oModel.create("/AccomSet",e,{success:function(e,s){a.show("Inserat erfolgreich angelegt!");i=e.Postid;setTimeout(function(){t.oRouter.navTo("RouteDetailAccommodation",{ID:"A"+i})},1500)},err+
or:function(){a.show("Fehler beim Speichern des Inserats!")}})},onFileSelected:function(e){var a=e.getSource();a.removeAllItems();var i=new t({name:"x-csrf-token",value:this.oModel.getSecurityToken()});a.addHeaderParameter(i);this.saveFileTemporary(e.get+
Parameter("files")[0])},saveFileTemporary:function(e){var t;var a=new FileReader;var i=this;a.onload=function(e){var a=e.target.result;var s;if(btoa(a)){s=btoa(a)}else{s=btoa(encodeURIComponent(a))}if(typeof base64file==="undefined"||typeof base64file===+
null){t=s}else{t=t+"new"+s}i.xBinary=t};a.readAsBinaryString(e)}})});                                                                                                                                                                                          
sap.ui.define(["Mosbach/StudiHub/controller/base.controller","sap/m/MessageToast","sap/m/UploadCollectionParameter"],function(e,t,a){"use strict";return e.extend("Mosbach.StudiHub.controller.Event.CreateEvent",{extendInit:function(){this.onLiveChange();t+
his.oRouter.getRoute("RouteCreateEvent").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(){this.byId("panelData").bindElement("/UserSet('"+this.oSession.getData().myUserId+"')");this.byId("inputHeader").setValue("");this.byId(+
"textArea").setValue("");this.byId("dateRange").setDateValue();this.byId("dateRange").setSecondDateValue();this.byId("UploadCollection").removeAllItems();this.xBinary=""},onLiveChange:function(){var e=this.byId("inputHeader").getValue();var t=this.byId("+
inputCompany").getValue();if(this.byId("dateRange").getSecondDateValue()){var a="Bis: "+this.dateFormatter(this.byId("dateRange").getSecondDateValue())}this.generateEventTile(e,t,a)},generateEventTile:function(e,t,a){var i=new sap.m.GenericTile;var n=new+
 sap.m.TileContent;i.addStyleClass("sapUiTinyMarginBegin");i.addStyleClass("sapUiTinyMarginTop");i.setFrameType("OneByOne");i.setHeader(e);i.setSubheader(t);i.setMode("HeaderMode");n.setFooter(a);i.addTileContent(n);this.byId("flexBoxPreview").destroyIte+
ms();this.byId("flexBoxPreview").addItem(i)},onSavePress:function(){var e=this.getEvent();if(this.fieldsValid(e)){this.saveEvent(e)}},getEvent:function(){return{Postid:"0",Userid:this.oSession.getData().myUserId,Begda:this.removeTimeZoneOffset(this.byId(+
"dateRange").getDateValue()),Endda:this.removeTimeZoneOffset(this.byId("dateRange").getSecondDateValue()),Title:this.byId("inputHeader").getValue(),Street:this.byId("inputStreet").getValue(),City:this.byId("inputCity").getValue(),Postcode:this.byId("inpu+
tPostcode").getValue(),Descr:this.byId("textArea").getValue(),Weblink:this.byId("inputWebsite").getValue(),Uname:"",Pdfsource:"",Pdfbinary:this.xBinary}},fieldsValid:function(e){var a=false;if(!e.Title){this.byId("inputHeader").setValueState("Error");a=t+
rue}else{this.byId("inputHeader").setValueState("None")}if(!e.Begda||!e.Endda){this.byId("dateRange").setValueState("Error");a=true}else{this.byId("dateRange").setValueState("None")}if(!e.Descr){this.byId("textArea").setValueState("Error");a=true}else{th+
is.byId("textArea").setValueState("None")}if(a){t.show("Bitte f√ºlle alle Pflichtfelder aus!")}return!a},saveEvent:function(e){var a=this;var i;this.oModel.create("/EventSet",e,{success:function(e,n){t.show("Event erfolgreich angelegt!");i=e.Postid;setTim+
eout(function(){a.oRouter.navTo("RouteDetailEvent",{ID:"E"+i})},1500)},error:function(){t.show("Fehler beim Speichern des Event!")}})},onFileSelected:function(e){var t=e.getSource();t.removeAllItems();var i=new a({name:"x-csrf-token",value:this.oModel.ge+
tSecurityToken()});t.addHeaderParameter(i);this.saveFileTemporary(e.getParameter("files")[0])},saveFileTemporary:function(e){var t;var a=new FileReader;var i=this;a.onload=function(e){var a=e.target.result;var n;if(btoa(a)){n=btoa(a)}else{n=btoa(encodeUR+
IComponent(a))}if(typeof base64file==="undefined"||typeof base64file===null){t=n}else{t=t+"new"+n}i.xBinary=t};a.readAsBinaryString(e)}})});                                                                                                                   
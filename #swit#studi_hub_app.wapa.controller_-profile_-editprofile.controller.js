sap.ui.define(["Mosbach/StudiHub/controller/base.controller","sap/m/MessageToast","sap/m/MessageBox"],function(e,t,i){"use strict";return e.extend("Mosbach.StudiHub.controller.Profile.EditProfile",{extendInit:function(){this.oRouter.getRoute("RouteEditPr+
ofile").attachPatternMatched(this._onObjectMatched,this)},pressNavBack:function(){this.oRouter.navTo("RouteDetailProfile",{userId:this.userId})},_onObjectMatched:function(e){this.userId=e.getParameter("arguments").userId;this.getView().bindElement("/User+
Set('"+this.userId.substr(1)+"')")},onPasswordPress:function(){if(!this.oDialog){this.oDialog=sap.ui.xmlfragment("PasswordDialog","Mosbach.StudiHub.view.fragments.NewPassword",this)}this.oDialog.open()},onDialogClose:function(){this.oDialog.close()},onSa+
vePress:function(){var e=this;i.show("Möchten Sie die Daten wirklich ändern?",{icon:i.Icon.WARNING,title:"Profil ändern",actions:[i.Action.YES,i.Action.NO],emphasizedAction:i.Action.YES,onClose:function(i){if(i=="YES"){var s=e.getView().getBindingContext+
().getObject().Usertype.substr(0,1);if(s==="A")s="U";if(s==="C")s="U";var o={Userid:e.userId.substr(1),Expires:e.byId("userExpires"+s).getDateValue(),Gender:e.byId("comboBoxGender").getSelectedKey(),Usertype:e.getView().getBindingContext().getObject().Us+
ertype,Company:e.byId("inputCompany").getValue(),Website:e.byId("inputWeblink").getValue(),Logo:"",Street:e.byId("inputStreet"+s).getValue(),City:e.byId("inputCity"+s).getValue(),Postcode:e.byId("inputPostcode"+s).getValue(),Beschreibung:e.byId("textArea+
").getValue(),Email:e.byId("inputEmail"+s).getValue(),Firstname:e.byId("inputFirstname").getValue(),Lastname:e.byId("inputLastname").getValue(),Lastlogin:e.getView().getBindingContext().getObject().Lastlogin};e.oModel.update("/UserSet('"+e.userId.substr(+
1)+"')",o,{success:function(i,s){sap.ui.core.BusyIndicator.hide();t.show("Das Speichern der Änderungen war erfolgreich!");setTimeout(function(){e.pressNavBack()},3e3)},error:function(e){sap.ui.core.BusyIndicator.hide();t.show("Fehler beim Speichern der Ä+
nderungen!")}})}else{return}}})},onDeletePress:function(){var e=this.getView().getBindingContext().getPath();var s=this;i.show("Möchten Sie dieses Profil wirklich löschen?",{icon:i.Icon.WARNING,title:"Profil löschen",actions:[i.Action.YES,i.Action.NO],em+
phasizedAction:i.Action.YES,onClose:function(i){if(i=="YES"){sap.ui.core.BusyIndicator.show();s.oModel.remove(e,{success:function(e){sap.ui.core.BusyIndicator.hide();t.show("Profil wurde erfolgreich gelöscht.");setTimeout(function(){s.oRouter.navTo("Rout+
eAdminPanel")},3e3);if(s.getView().getBindingContext().getPath().includes(s.oSession.getData().myUserId))window.location.reload()},error:function(e){sap.ui.core.BusyIndicator.hide();t.show("Ein Fehler ist aufgetreten. Profil konnte nicht gelöscht werden.+
")}})}else{return}}})},onValidatePress:function(){var e=this;var i=sap.ui.core.Fragment.byId("PasswordDialog","inputOldPw").getValue();var s=sap.ui.core.Fragment.byId("PasswordDialog","inputNewPw").getValue();var o=sap.ui.core.Fragment.byId("PasswordDial+
og","inputNewPw2").getValue();var a=false;var n={email:this.getView().getBindingContext().getObject().Email,password:s,authorized:"",userid:this.getView().getBindingContext().getObject().Userid,usertype:""};if(!i){sap.ui.core.Fragment.byId("PasswordDialo+
g","inputOldPw").setValueState("Error");a=true}else{sap.ui.core.Fragment.byId("PasswordDialog","inputOldPw").setValueState("None")}if(!s){sap.ui.core.Fragment.byId("PasswordDialog","inputNewPw").setValueState("Error");a=true}else{sap.ui.core.Fragment.byI+
d("PasswordDialog","inputNewPw").setValueState("None")}if(!o){sap.ui.core.Fragment.byId("PasswordDialog","inputNewPw2").setValueState("Error");a=true}else{sap.ui.core.Fragment.byId("PasswordDialog","inputNewPw2").setValueState("None")}if(!a){if(s!==o){t.+
show("Das neuen Passwörter stimmen nicht überein");sap.ui.core.Fragment.byId("PasswordDialog","inputNewPw").setValueState("Error");sap.ui.core.Fragment.byId("PasswordDialog","inputNewPw2").setValueState("Error")}else{sap.ui.core.Fragment.byId("PasswordDi+
alog","inputNewPw").setValueState("None");sap.ui.core.Fragment.byId("PasswordDialog","inputNewPw2").setValueState("None");this.oModel.read("/AuthSet(email='"+this.getView().getBindingContext().getObject().Email+"',password='"+i+"')",{success:function(s,o+
){e.oModel.update("/AuthSet(email='"+e.getView().getBindingContext().getObject().Email+"',password='"+i+"')",n,{success:function(){t.show("Passwort erfolgreich gespeichert!");e.oDialog.close()}})},error:function(e){t.show("Das angegebene Passwort war fal+
sch! Probiere es nochmal!")}})}}else{t.show("Fülle bitte alle Felder aus!")}}})});                                                                                                                                                                             
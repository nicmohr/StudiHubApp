sap.ui.define(["Mosbach/StudiHub/controller/base.controller","sap/m/UploadCollectionParameter","sap/m/MessageBox","sap/m/MessageToast"],function(e,t,a,i){"use strict";return e.extend("Mosbach.StudiHub.controller.Carrer.EditCareer",{extendInit:function(){+
this.oRouter=sap.ui.core.UIComponent.getRouterFor(this);this.oRouter.getRoute("RouteEditCareer").attachPatternMatched(this._onObjectMatched,this);this.onLiveChange()},_onObjectMatched:function(e){var t=this;this.xBinary="";this.postId=e.getParameter("arg+
uments").ID;this.byId("UploadCollection").removeAllItems();this.oModel.read("/CareerSet('"+this.postId.substr(1)+"')",{success:function(e){if(e.Pdfsource){t.byId("UploadCollection").addItem(new sap.m.UploadCollectionItem({fileName:"DATEI"}))}}});this.get+
View().bindElement("/CareerSet('"+this.postId.substr(1)+"')");setTimeout(function(e,a){t.onLiveChange()},1500);this.xBinary=""},pressNavBack:function(){this.oRouter.navTo("RouteDetailCareer",{ID:this.postId})},onLiveChange:function(e){var t=this.byId("in+
putHeader").getValue();var a=this.byId("inputCategory").getValue();var i=this.byId("ImageType").getSelectedButton();var r=this.byId("inputImage").getValue();if(this.byId("dateRange").getSecondDateValue()){var s="Bis: "+this.dateFormatter(this.byId("dateR+
ange").getSecondDateValue())}var n;if(i){n=i.split("--")[1].split("-")[0]}else{n="BackgroundImage"}this.generateCareerTile(t,a,s,n,r)},generateCareerTile:function(e,t,a,i,r){var s=new sap.m.GenericTile;var n=new sap.m.TileContent;var o=new sap.m.NewsCont+
ent;s["set"+i](r);s.setFrameType("TwoByOne");n.setFooter(a);o.setContentText(e);o.setSubheader(t);n.setContent(o);s.addTileContent(n);this.byId("flexBoxPreview").destroyItems();this.byId("flexBoxPreview").addItem(s)},getCareer:function(){return{Postid:th+
is.getView().getBindingContext().getObject().Postid,Userid:this.oSession.getData().myUserId,Begda:this.removeTimeZoneOffset(this.byId("dateRange").getDateValue()),Endda:this.removeTimeZoneOffset(this.byId("dateRange").getSecondDateValue()),Title:this.byI+
d("inputHeader").getValue(),Category:this.byId("inputCategory").getValue(),Imgtype:this.byId("ImageType").getSelectedKey(),Imgurl:this.byId("inputImage").getValue(),Street:this.byId("inputStreet").getValue(),City:this.byId("inputCity").getValue(),Postcod+
e:this.byId("inputPostcode").getValue(),Descr:this.byId("textArea").getValue(),Weblink:this.byId("inputWebsite").getValue(),Pdfsource:this.getView().getBindingContext().getObject().Pdfsource,Pdfbinary:this.xBinary,Uname:""}},onSavePress:function(){var e=+
this.getCareer();if(this.fieldsValid(e)){this.saveCareer(e)}},onDeletePress:function(){var e=this.getCareer();var t=this;a.warning("Wollen Sie wirklich das Karriereangebot: '"+e.Title+"' löschen?",{actions:["Löschen",a.Action.CLOSE],emphasizedAction:"Lös+
chen",onClose:function(e){if(e=="Löschen"){t.oModel.remove("/CareerSet('"+t.postId.substr(1)+"')",{success:function(){i.show("Karriereangebot erfolgreich gelöscht!");setTimeout(function(){t.navToMaster()},1500)},error:function(){i.show("Fehler beim Lösch+
en des Karriereangebots!")}})}else{}}})},fieldsValid:function(e){var t=false;if(!e.Title){this.byId("inputHeader").setValueState("Error");t=true}else{this.byId("inputHeader").setValueState("None")}if(!e.Category){this.byId("inputCategory").setValueState(+
"Error");t=true}else{this.byId("inputCategory").setValueState("None")}if(!e.Begda||!e.Endda){this.byId("dateRange").setValueState("Error");t=true}else{this.byId("dateRange").setValueState("None")}if(!e.Descr){this.byId("textArea").setValueState("Error");+
t=true}else{this.byId("textArea").setValueState("None")}if(t){i.show("Bitte fülle alle Pflichtfelder aus!")}return!t},saveCareer:function(e){var t=this;var a;if(this.byId("UploadCollection").getItems().length===0){e.Pdfsource=""}this.oModel.update("/Care+
erSet('"+e.Postid+"')",e,{success:function(r,s){i.show("Karriereangebot erfolgreich angelegt!");a=e.Postid;setTimeout(function(){t.oRouter.navTo("RouteDetailCareer",{ID:"K"+a})},1500)},error:function(){i.show("Fehler beim Speichern des Karriereangebots!"+
)}})},onFileSelected:function(e){var a=e.getSource();a.removeAllItems();var i=new t({name:"x-csrf-token",value:this.oModel.getSecurityToken()});a.addHeaderParameter(i);this.saveFileTemporary(e.getParameter("files")[0])},saveFileTemporary:function(e){var +
t;var a=new FileReader;var i=this;a.onload=function(e){var a=e.target.result;var r;if(btoa(a)){r=btoa(a)}else{r=btoa(encodeURIComponent(a))}if(typeof base64file==="undefined"||typeof base64file===null){t=r}else{t=t+"new"+r}i.xBinary=t};a.readAsBinaryStri+
ng(e)}})});                                                                                                                                                                                                                                                    